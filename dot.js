define([
    "https://cdn.staticfile.org/echarts/4.3.0/echarts.min.js"
], function(echarts) {
    var chartDom = document.getElementById('main');
    var myChart = echarts.init(chartDom);
    const dataBronx = [
        ['2019-07-02T00:00:00.000000Z',9,3.97,115,'Port Morris'],
        ['2017-10-10T00:00:00.000000Z',14,0.39,22,'Highbridge'],
        ['2019-01-01T00:00:00.000000Z',2,0.22,90,'Fordham'],
        ['2019-06-18T00:00:00.000000Z',60,2.59,55,'East Morrisania'],
        ['2019-03-28T00:00:00.000000Z',10,0.41,71,'Fordham'],
        ['2019-06-28T00:00:00.000000Z',122,8.24,34,'Woodlawn'],
        ['2019-01-15T00:00:00.000000Z',10,0.79,50,'Parkchester'],
        ['2019-06-23T00:00:00.000000Z',57,1.17,100,'Mott Haven'],
        ['2018-05-19T00:00:00.000000Z',1,0.07,68,'Woodlawn'],
        ['2018-10-21T00:00:00.000000Z',1,0.11,300,'Clason Point'],
        ['2019-06-23T00:00:00.000000Z',6,1.96,60,'Fordham'],
        ['2018-10-13T00:00:00.000000Z',10,0.16,55,'Fordham'],
        ['2019-05-28T00:00:00.000000Z',26,0.85,65,'Longwood'],
        ['2018-09-24T00:00:00.000000Z',1,0.1,40,'Fordham'],
        ['2018-08-04T00:00:00.000000Z',11,0.88,125,'Edenwald'],
        ['2016-08-14T00:00:00.000000Z',6,0.14,95,'Concourse Village'],
        ['2018-07-23T00:00:00.000000Z',2,0.17,35,'Allerton'],
        ['2019-07-02T00:00:00.000000Z',14,0.7,35,'Parkchester'],
        ['2019-05-19T00:00:00.000000Z',13,0.57,75,'Fordham'],
        ['2019-06-09T00:00:00.000000Z',7,0.2,110,'Port Morris'],
        ['2019-01-13T00:00:00.000000Z',1,0.17,60,'Wakefield'],
        ['2019-04-06T00:00:00.000000Z',13,0.58,100,'Mott Haven'],
        ['2019-04-16T00:00:00.000000Z',40,1.58,47,'Pelham Gardens'],
        ['2018-11-12T00:00:00.000000Z',8,0.23,50,'Allerton'],
        ['2019-07-05T00:00:00.000000Z',27,8.62,95,'Clason Point'],
        ['2019-04-28T00:00:00.000000Z',3,0.47,70,'Clason Point'],
        ['2019-07-02T00:00:00.000000Z',30,2.56,142,'Allerton'],
        ['2019-06-24T00:00:00.000000Z',36,3.33,79,'Bronxdale'],
        ['2019-06-23T00:00:00.000000Z',6,2.95,70,'Longwood'],
        ['2019-07-02T00:00:00.000000Z',28,8.32,60,'Allerton'],
        ['2019-07-03T00:00:00.000000Z',32,3.09,280,'Williamsbridge'],
        ['2019-06-25T00:00:00.000000Z',6,1.18,65,'Fordham'],
        ['2019-07-02T00:00:00.000000Z',9,3.42,109,'Port Morris'],
        ['2019-07-04T00:00:00.000000Z',5,3.13,35,'Wakefield'],
        ['2019-06-29T00:00:00.000000Z',26,2.83,65,'Belmont'],
        ['2019-06-30T00:00:00.000000Z',58,6.8,90,'Longwood'],
        ['2019-06-19T00:00:00.000000Z',33,1.47,45,'Williamsbridge'],
        ['2019-07-06T00:00:00.000000Z',28,6.72,40,'Belmont'],
        ['2019-06-23T00:00:00.000000Z',95,1.91,110,'Clason Point'],
        ['2019-07-04T00:00:00.000000Z',1,1.0,65,'Woodlawn'],
        ['2019-06-17T00:00:00.000000Z',14,0.61,73,'Morris Park'],
        ['2017-05-12T00:00:00.000000Z',1,0.04,90,'Concourse Village'],
        ['2019-05-04T00:00:00.000000Z',2,0.81,50,'Port Morris'],
        ['2019-05-19T00:00:00.000000Z',20,2.29,60,'Morris Park'],
        ['2019-06-06T00:00:00.000000Z',113,2.42,59,'Pelham Bay'],
        ['2019-06-24T00:00:00.000000Z',63,1.15,37,'Kingsbridge'],
        ['2019-07-04T00:00:00.000000Z',6,6.0,85,'Williamsbridge'],
        ['2019-06-17T00:00:00.000000Z',50,3.02,75,'Edenwald'],
        ['2019-05-27T00:00:00.000000Z',29,3.09,28,'Port Morris'],
        ['2019-06-24T00:00:00.000000Z',107,2.3,65,'Concourse Village'],
        ['2019-06-20T00:00:00.000000Z',4,3.24,56,'Williamsbridge'],
        ['2019-05-10T00:00:00.000000Z',2,0.58,41,'Wakefield'],
        ['2019-06-30T00:00:00.000000Z',6,0.18,115,'Eastchester'],
        ['2019-02-28T00:00:00.000000Z',13,0.28,37,'Hunts Point'],
        ['2018-08-02T00:00:00.000000Z',8,0.23,38,'Claremont Village'],
        ['2019-07-02T00:00:00.000000Z',36,3.5,142,'Allerton'],
        ['2019-06-28T00:00:00.000000Z',19,3.85,74,'Highbridge'],
        ['2019-06-21T00:00:00.000000Z',38,4.75,55,'Mott Haven'],
        ['2019-07-05T00:00:00.000000Z',23,1.77,74,'Throgs Neck'],
        ['2019-05-19T00:00:00.000000Z',7,1.54,50,'Tremont'],
        ['2019-06-28T00:00:00.000000Z',130,5.76,50,'Wakefield'],
        ['2019-06-21T00:00:00.000000Z',42,0.74,49,'Allerton'],
        ['2019-06-30T00:00:00.000000Z',5,5.0,87,'Williamsbridge'],
        ['2019-06-01T00:00:00.000000Z',23,0.96,45,'Parkchester'],
        ['2019-05-01T00:00:00.000000Z',37,1.81,40,'Pelham Gardens'],
        ['2017-01-01T00:00:00.000000Z',2,0.05,49,'Riverdale'],
        ['2019-06-23T00:00:00.000000Z',45,2.51,40,'Longwood'],
        ['2017-12-25T00:00:00.000000Z',3,0.1,60,'Norwood'],
        ['2019-06-25T00:00:00.000000Z',170,5.16,100,'Mott Haven'],
        ['2019-06-16T00:00:00.000000Z',2,2.0,28,'Port Morris'],
        ['2019-06-17T00:00:00.000000Z',1,1.0,35,'Van Nest'],
        ['2019-06-12T00:00:00.000000Z',205,5.39,67,'Williamsbridge'],
        ['2018-10-02T00:00:00.000000Z',2,0.09,80,'Clason Point'],
        ['2018-01-03T00:00:00.000000Z',8,0.19,60,'Longwood'],
        ['2018-09-02T00:00:00.000000Z',11,0.18,85,'Concourse'],
        ['2019-06-30T00:00:00.000000Z',44,3.91,132,'Mott Haven'],
        ['2019-06-03T00:00:00.000000Z',59,2.89,58,'Claremont Village'],
        ['2019-07-03T00:00:00.000000Z',46,2.16,55,'Concourse Village'],
        ['2019-06-13T00:00:00.000000Z',37,2.63,74,'Throgs Neck'],
        ['2019-06-09T00:00:00.000000Z',31,3.01,140,'Throgs Neck'],
        ['2019-06-26T00:00:00.000000Z',1,1.0,79,'Pelham Gardens'],
        ['2019-07-03T00:00:00.000000Z',22,6.8,107,'Fordham'],
        ['2019-07-07T00:00:00.000000Z',22,2.4,60,'East Morrisania'],
        ['2019-06-30T00:00:00.000000Z',3,1.13,46,'Clason Point'],
        ['2018-12-12T00:00:00.000000Z',4,0.19,127,'Claremont Village'],
        ['2019-05-31T00:00:00.000000Z',5,0.66,95,'Edenwald'],
        ['2019-06-21T00:00:00.000000Z',2,2.0,75,'Concourse Village'],
        ['2019-03-07T00:00:00.000000Z',10,0.67,26,'Olinville'],
        ['2019-06-14T00:00:00.000000Z',4,2.07,150,'Pelham Gardens'],
        ['2019-06-23T00:00:00.000000Z',71,3.45,140,'Belmont'],
        ['2019-06-20T00:00:00.000000Z',32,2.96,55,'Parkchester'],
        ['2019-06-16T00:00:00.000000Z',8,1.11,60,'Spuyten Duyvil'],
        ['2019-07-03T00:00:00.000000Z',47,1.22,120,'Spuyten Duyvil'],
        ['2019-07-01T00:00:00.000000Z',4,4.0,95,'Kingsbridge'],
        ['2019-06-10T00:00:00.000000Z',86,2.76,86,'Castle Hill'],
        ['2019-06-30T00:00:00.000000Z',7,0.99,125,'Pelham Bay'],
        ['2019-06-12T00:00:00.000000Z',45,3.0,79,'Kingsbridge'],
        ['2019-06-24T00:00:00.000000Z',2,1.71,60,'Throgs Neck'],
        ['2019-06-24T00:00:00.000000Z',28,3.07,45,'Concourse'],
        ['2019-04-05T00:00:00.000000Z',59,1.0,40,'Mount Hope']
    ];
    const dataMan=[
        ['2019-06-18T00:00:00.000000Z',6,1.58,260,'Upper West Side'],
        ['2019-06-09T00:00:00.000000Z',66,0.83,199,'Nolita'],
        ['2019-04-06T00:00:00.000000Z',11,0.3,150,'Upper East Side'],
        ['2019-07-05T00:00:00.000000Z',13,0.6,273,'Hell Kitchen'],
        ['2019-03-11T00:00:00.000000Z',1,0.25,115,'East Village'],
        ['2018-11-01T00:00:00.000000Z',3,0.12,100,'Hell Kitchen'],
        ['2018-01-01T00:00:00.000000Z',2,0.07,200,'East Village'],
        ['2019-06-23T00:00:00.000000Z',16,1.26,125,'Upper East Side'],
        ['2019-05-21T00:00:00.000000Z',36,0.75,190,'Upper East Side'],
        ['2019-07-02T00:00:00.000000Z',22,0.45,244,'East Village'],
        ['2019-06-15T00:00:00.000000Z',13,3.42,50,'Harlem'],
        ['2019-02-11T00:00:00.000000Z',37,0.65,145,'Hell Kitchen'],
        ['2019-06-14T00:00:00.000000Z',25,1.2,150,'Harlem'],
        ['2019-07-06T00:00:00.000000Z',3,0.22,57,'Harlem'],
        ['2019-06-17T00:00:00.000000Z',3,1.73,250,'East Village'],
        ['2019-06-07T00:00:00.000000Z',29,1.14,169,'East Village'],
        ['2019-06-13T00:00:00.000000Z',42,1.13,109,'Lower East Side'],
        ['2019-06-17T00:00:00.000000Z',10,3.7,236,'Financial District'],
        ['2019-07-03T00:00:00.000000Z',2,2.0,429,'SoHo'],
        ['2015-10-31T00:00:00.000000Z',2,0.03,130,'Tribeca'],
        ['2019-06-30T00:00:00.000000Z',11,1.18,100,'Harlem'],
        ['2017-12-19T00:00:00.000000Z',1,0.05,75,'Lower East Side'],
        ['2019-06-20T00:00:00.000000Z',58,1.72,165,'Chelsea'],
        ['2019-06-23T00:00:00.000000Z',3,2.5,225,'Financial District'],
        ['2019-06-28T00:00:00.000000Z',90,1.97,115,'Upper East Side'],
        ['2018-03-19T00:00:00.000000Z',7,0.22,135,'Upper West Side'],
        ['2019-06-09T00:00:00.000000Z',38,0.72,1000,'Harlem'],
        ['2018-12-15T00:00:00.000000Z',3,0.31,375,'Lower East Side'],
        ['2019-06-23T00:00:00.000000Z',119,5.78,70,'Kips Bay'],
        ['2019-05-23T00:00:00.000000Z',134,2.48,35,'Upper West Side'],
        ['2018-10-01T00:00:00.000000Z',1,0.11,36,'East Harlem'],
        ['2018-10-15T00:00:00.000000Z',6,0.55,75,'Harlem'],
        ['2019-06-12T00:00:00.000000Z',163,7.27,82,'East Harlem'],
        ['2019-06-29T00:00:00.000000Z',9,0.49,589,'Upper East Side'],
        ['2019-06-13T00:00:00.000000Z',25,0.37,140,'East Village'],
        ['2019-06-23T00:00:00.000000Z',210,3.93,160,'East Village'],
        ['2019-06-24T00:00:00.000000Z',40,0.83,159,'West Village'],
        ['2019-06-21T00:00:00.000000Z',53,3.0,125,'Hell Kitchen'],
        ['2019-06-13T00:00:00.000000Z',134,2.69,80,'East Harlem'],
        ['2019-07-07T00:00:00.000000Z',6,6.0,249,'Chelsea'],
        ['2019-06-26T00:00:00.000000Z',32,2.92,179,'East Village'],
        ['2019-03-21T00:00:00.000000Z',16,0.49,252,'Midtown'],
        ['2019-06-14T00:00:00.000000Z',2,0.4,1000,'Tribeca'],
        ['2019-06-26T00:00:00.000000Z',32,1.39,80,'SoHo'],
        ['2019-06-24T00:00:00.000000Z',175,3.34,110,'Chinatown'],
        ['2018-12-02T00:00:00.000000Z',10,0.54,240,'Financial District'],
        ['2018-10-08T00:00:00.000000Z',31,0.4,100,'Washington Heights'],
        ['2019-05-03T00:00:00.000000Z',26,1.73,54,'Harlem'],
        ['2019-04-06T00:00:00.000000Z',4,0.37,56,'Harlem'],
        ['2019-06-17T00:00:00.000000Z',78,2.32,60,'Harlem'],
        ['2019-06-14T00:00:00.000000Z',35,3.79,135,'Kips Bay'],
        ['2019-01-01T00:00:00.000000Z',4,0.55,115,'Financial District'],
        ['2018-08-23T00:00:00.000000Z',188,1.94,250,'Upper West Side'],
        ['2018-12-29T00:00:00.000000Z',1,0.16,675,'Midtown'],
        ['2019-06-27T00:00:00.000000Z',92,3.08,233,'Chelsea'],
        ['2019-05-11T00:00:00.000000Z',13,0.36,39,'Washington Heights'],
        ['2019-07-07T00:00:00.000000Z',51,6.95,95,'Harlem'],
        ['2018-12-09T00:00:00.000000Z',7,0.55,70,'Upper East Side'],
        ['2015-10-19T00:00:00.000000Z',9,0.17,2000,'Upper West Side'],
        ['2019-06-29T00:00:00.000000Z',126,2.61,70,'Chelsea'],
        ['2019-06-19T00:00:00.000000Z',1,1.0,299,'West Village'],
        ['2018-09-26T00:00:00.000000Z',5,0.15,500,'Midtown'],
        ['2019-06-14T00:00:00.000000Z',88,1.42,52,'Harlem'],
        ['2019-06-30T00:00:00.000000Z',18,5.74,350,'Chinatown'],
        ['2019-06-15T00:00:00.000000Z',33,0.9,123,'Nolita'],
        ['2019-06-21T00:00:00.000000Z',7,3.13,203,'Financial District'],
        ['2019-06-29T00:00:00.000000Z',64,2.46,145,'East Village'],
        ['2018-08-31T00:00:00.000000Z',4,0.08,260,'East Village'],
        ['2019-05-06T00:00:00.000000Z',33,1.18,250,'Gramercy'],
        ['2019-05-28T00:00:00.000000Z',3,0.48,65,'Harlem'],
        ['2019-06-02T00:00:00.000000Z',17,2.9,116,'East Harlem'],
        ['2019-07-05T00:00:00.000000Z',35,3.9,110,'East Harlem'],
        ['2018-10-17T00:00:00.000000Z',7,0.1,150,'Hell Kitchen'],
        ['2019-05-21T00:00:00.000000Z',9,0.14,65,'Harlem'],
        ['2019-06-19T00:00:00.000000Z',2,0.77,225,'Hell Kitchen'],
        ['2019-06-14T00:00:00.000000Z',46,0.57,141,'Upper East Side'],
        ['2019-07-05T00:00:00.000000Z',25,7.98,144,'Hell Kitchen'],
        ['2019-06-08T00:00:00.000000Z',7,1.69,120,'Harlem'],
        ['2019-05-14T00:00:00.000000Z',4,0.49,39,'Kips Bay'],
        ['2019-04-16T00:00:00.000000Z',2,0.29,232,'Chelsea'],
        ['2019-05-26T00:00:00.000000Z',5,0.55,375,'West Village'],
        ['2019-06-29T00:00:00.000000Z',2,2.0,225,'East Harlem'],
        ['2019-06-14T00:00:00.000000Z',3,2.73,295,'Chinatown'],
        ['2018-07-13T00:00:00.000000Z',1,0.08,250,'Upper West Side'],
        ['2019-06-05T00:00:00.000000Z',12,2.32,45,'Washington Heights'],
        ['2019-06-23T00:00:00.000000Z',188,1.5,85,'Hell Kitchen'],
        ['2019-06-24T00:00:00.000000Z',10,1.8,200,'Hell Kitchen'],
        ['2018-06-30T00:00:00.000000Z',7,0.23,78,'Lower East Side'],
        ['2019-06-28T00:00:00.000000Z',150,2.42,135,'Hell Kitchen'],
        ['2019-06-13T00:00:00.000000Z',1,1.0,175,'Chelsea'],
        ['2019-05-10T00:00:00.000000Z',9,0.53,92,'Chinatown'],
        ['2018-10-15T00:00:00.000000Z',9,0.18,115,'Harlem'],
        ['2019-06-18T00:00:00.000000Z',9,2.48,196,'Financial District'],
        ['2019-05-26T00:00:00.000000Z',7,1.69,229,'Financial District'],
        ['2019-06-01T00:00:00.000000Z',1,0.79,125,'Flatiron District'],
        ['2019-07-01T00:00:00.000000Z',6,0.82,495,'East Village'],
        ['2019-05-12T00:00:00.000000Z',1,0.51,170,'Midtown'],
        ['2019-05-27T00:00:00.000000Z',116,1.65,175,'Midtown'],
        ['2018-03-01T00:00:00.000000Z',2,0.1,175,'Financial District'],
        ['2019-07-01T00:00:00.000000Z',29,2.2,249,'Midtown']
    ];
    const schema = [
        { name: "date", value: 0, text: "Last day of review" },
        { name: "num_of_review", value: 1, text: "Number of Reviews" },
        { name: "reviews_per_month", value: 2, text: "Reviews per Month" },
        { name: "Price", value: 3, text: "Price" },
        { name: "neighbourhood", value: 4, text: "Neighbourhood" }
    ];
    const itemStyle = {
        opacity: 0.8,
        shadowBlur: 10,
        shadowOffsetX: 0,
        shadowOffsetY: 0,
        shadowColor: "rgba(0,0,0,0.3)"
    };
    option = {
        color: ["#dd4444","#fec42c"],
        legend: {
            top: 10,
            data: ["Bronx","Manhattan"],
            textStyle: {
                fontSize: 16
            }
        },
        grid: {
            left: "10%",
            right: 150,
            top: "18%",
            bottom: "10%"
        },
        tooltip: {
            backgroundColor: "rgba(0,255,255,0.7)",
            formatter: function (param) {
                var value = param.value;
                var date = new Date(value[0]);
                var formattedDate = date.getFullYear() + "-" + (date.getMonth() + 1) + "-" + date.getDate();
                return schema[0].text + ": " + formattedDate + "<br/>" +
                    schema[1].text + ": " + value[1] + "<br/>" +
                    schema[2].text + ": " + value[2] + "<br/>" +
                    schema[3].text + ": " + value[3] + "<br/>" +
                    schema[4].text + ": " + value[4];
            }
        },
        xAxis: {
            type: "time",
            name: "Date",
            splitLine: {
                show: false
            },
            axisLine: {
                lineStyle: {
                    color: "#999"
                }
            }
        },
        yAxis: {
            type: "value",
            name: "Number of Reviews",
            axisLine: {
                lineStyle: {
                    color: "#999"
                }
            },
            splitLine: {
                show: false
            }
        },
        visualMap: {
            left: 'right',
            top: '10%',
            dimension: 2,
            min: 0,
            max: 20,
            itemWidth: 30,
            itemHeight: 120,
            show: true,
            calculable: true,
            precision: 0.1,
            text: ['Size of Circles：\n Reviews per Month'],
            textGap: 30,
            inRange: {
                symbolSize: [10, 70]
            },
            outOfRange: {
                symbolSize: [10, 70],
                color: ['rgba(255,255,255,0.4)']
            },
            controller: {
                inRange: {
                    color: ['#c23531']
                },
                outOfRange: {
                    color: ['#999']
                }
            }
        },
        series: [
            {
                name: "Bronx",
                type: "scatter",
                itemStyle: itemStyle,
                data: dataBronx.map(function (item) {
                    return [
                        new Date(item[0]),
                        item[1],
                        item[2],
                        item[3],
                        item[4]
                    ];
                })
            },
            {
                name: "Manhattan",
                type: "scatter",
                itemStyle: itemStyle,
                data: dataMan.map(function (item) {
                    return [
                        new Date(item[0]),
                        item[1],
                        item[2],
                        item[3],
                        item[4]
                    ];
                })
            }
        ]
    };
    option && myChart.setOption(option);
})